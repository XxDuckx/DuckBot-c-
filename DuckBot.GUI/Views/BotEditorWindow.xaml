<Window x:Class="DuckBot.GUI.Views.BotEditorWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Bot Editor" Height="520" Width="720"
        WindowStartupLocation="CenterOwner"
        ResizeMode="NoResize">
    <Grid Margin="12">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <StackPanel Orientation="Horizontal" Grid.Row="0" Margin="0,0,0,8">
            <TextBlock Text="Script name:" VerticalAlignment="Center" Margin="0,0,8,0"/>
            <TextBox Width="300" Text="{Binding Script.Name, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
        </StackPanel>

        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="2*"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- Left: variables editor -->
            <Border Grid.Column="0" Background="{StaticResource SurfaceBrush}" Padding="8" Margin="0,0,8,0">
                <StackPanel>
                    <TextBlock Text="Variables" FontWeight="SemiBold" Margin="0,0,0,8"/>
                    <ItemsControl ItemsSource="{Binding Script.Variables}">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <StackPanel Orientation="Horizontal" Margin="0,4,0,0">
                                    <TextBox Width="140" Text="{Binding Key, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                                    <TextBox Width="200" Margin="8,0,8,0" Text="{Binding Default, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                                    <Button Content="Remove" Width="80" Command="{Binding DataContext.RemoveVariableCommand, RelativeSource={RelativeSource AncestorType=Window}}" CommandParameter="{Binding}"/>
                                </StackPanel>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>

                    <Button Content="Add variable" Width="120" Margin="0,12,0,0" Command="{Binding AddVariableCommand}"/>
                </StackPanel>
            </Border>

            <!-- Right: quick JSON preview -->
            <Border Grid.Column="1" Background="{StaticResource SurfaceAltBrush}" Padding="8">
                <StackPanel>
                    <TextBlock Text="Script JSON Preview" FontWeight="SemiBold" Margin="0,0,0,8"/>
                    <TextBox Text="{Binding ScriptJsonPreview}" AcceptsReturn="True" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto" IsReadOnly="True" Height="360" />
                </StackPanel>
            </Border>
        </Grid>

        <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,12,0,0">
            <Button Content="Save" Width="100" Margin="0,0,8,0" Click="Save_Click"/>
            <Button Content="Close" Width="100" Click="Close_Click"/>
        </StackPanel>
    </Grid>
</Window>